{"version":3,"file":"uteis.js","sourceRoot":"","sources":["../../../src/gerais/uteis.ts"],"names":[],"mappings":"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","sourcesContent":["import { exibirAviso, TipoAviso } from \"./mensageria.js\";\n\n/**\n * @summary Copia o texto informado para a área de transferência e exibe mensagem de sucesso/erro.\n */\nexport async function copiarTextoParaAreaTransferencia(\n    texto: string,\n    areaAviso?: HTMLDivElement,\n    mensagemSucesso: string = \"Conteúdo copiado!\",\n): Promise<boolean> {\n    try {\n        await navigator.clipboard.writeText(texto);\n        if (areaAviso) {\n            exibirAviso(areaAviso, mensagemSucesso, TipoAviso.InfoAlternativo);\n        }\n        return true;\n    } catch {\n        if (areaAviso) {\n            exibirAviso(areaAviso, \"Não foi possível copiar!\", TipoAviso.Erro);\n        }\n        return false;\n    }\n}\n\n/**\n * @summary Retorna a área de aviso (toast) disponível na página, se existir.\n */\nfunction obterAreaAviso(): HTMLDivElement | undefined {\n    return (\n        (document.getElementById(\"toast\") as HTMLDivElement | null) ||\n        (document.getElementById(\"feedback-toast\") as HTMLDivElement | null) ||\n        undefined\n    );\n}\n\n/**\n * @summary Obtém o texto de um elemento pelo seletor, priorizando o conteúdo de <code>.\n */\nfunction obterTextoParaCopiar(selector: string): string {\n    const alvo = document.querySelector<HTMLElement>(selector);\n    if (!alvo) throw new Error(`Alvo não encontrado: ${selector}`);\n    const code = alvo.querySelector<HTMLElement>(\"code\");\n    const fonte = code ?? alvo;\n    const texto = (fonte.innerText ?? fonte.textContent ?? \"\").trim();\n    return texto;\n}\n\n/**\n * @summary Lida com cliques em botões com atributo data-copy-target e copia o conteúdo alvo.\n */\ndocument.addEventListener(\"click\", async (ev) => {\n    const origem = ev.target as HTMLElement | null;\n    if (!origem) return;\n    const botao = origem.closest<HTMLElement>(\"[data-copy-target]\");\n    if (!botao) return;\n    const seletor = botao.getAttribute(\"data-copy-target\");\n    if (!seletor) return;\n    ev.preventDefault();\n    try {\n        const texto = obterTextoParaCopiar(seletor);\n        await copiarTextoParaAreaTransferencia(texto, obterAreaAviso());\n    } catch {\n        await copiarTextoParaAreaTransferencia(\"\", obterAreaAviso());\n    }\n});\n\n/**\n * @summary Retorna o elemento de feedback de compartilhamento, se presente.\n */\nfunction obterFeedbackCompartilhamento(): HTMLParagraphElement | undefined {\n    return document.getElementById(\"feedback-compartilhamento\") as HTMLParagraphElement | undefined;\n}\n\n/**\n * @summary Obtém o conteúdo da meta tag de descrição da página.\n */\nfunction obterMetaDescricao(): string | undefined {\n    const meta = document.querySelector<HTMLMetaElement>('meta[name=\"description\"]');\n    return meta?.content?.trim() || undefined;\n}\n\n/**\n * @summary Retorna a URL canônica da página, ou o location.href como fallback.\n */\nfunction obterUrlCompartilhamento(): string {\n    const link = document.querySelector<HTMLLinkElement>('link[rel=\"canonical\"]');\n    return (link?.href?.trim() || location.href);\n}\n\n/**\n * @summary Tenta compartilhar a página via Web Share API; se não disponível, copia o link.\n */\nasync function compartilharAtual(): Promise<void> {\n    const url = obterUrlCompartilhamento();\n    const titulo = document.title;\n    const texto = obterMetaDescricao() || titulo;\n    const area = obterAreaAviso();\n    const feedback = obterFeedbackCompartilhamento();\n\n    try {\n        if (navigator.share) {\n            await navigator.share({ title: titulo, text: texto, url });\n            if (feedback) feedback.textContent = \"Compartilhado!\";\n            if (area) exibirAviso(area, \"Compartilhado!\", TipoAviso.Sucesso);\n            return;\n        }\n        // Fallback: copiar URL\n        await copiarTextoParaAreaTransferencia(url, area, \"Link copiado!\");\n        if (feedback) feedback.textContent = \"Link copiado para a área de transferência.\";\n    } catch (e: unknown) {\n        const nome = (e as any)?.name as string | undefined;\n        if (nome === \"AbortError\") return;\n        await copiarTextoParaAreaTransferencia(url, area, \"Link copiado!\");\n        if (feedback) feedback.textContent = \"Link copiado para a área de transferência.\";\n    }\n}\n\n/**\n * @summary Lida com cliques em elementos de compartilhamento e aciona a função de compartilhamento.\n */\ndocument.addEventListener(\"click\", (ev) => {\n    const alvo = ev.target as HTMLElement | null;\n    if (!alvo) return;\n    const share = alvo.closest<HTMLElement>(\"#botao-compartilhar, [data-share]\");\n    if (!share) return;\n    ev.preventDefault();\n    compartilharAtual();\n});\n"]}