{"version":3,"file":"uteis.js","sourceRoot":"","sources":["../../../src/gerais/uteis.ts"],"names":[],"mappings":"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","sourcesContent":["/* ============================\r\n   Métodos auxiliares gerais\r\n============================ */\r\n\r\n\r\nimport { exibirAviso, TipoAviso } from \"./mensageria.js\";\n\ndeclare global {\n    interface Window {\n        __gtmInjected?: boolean;\n    }\n}\n\r\n/**\r\n * @summary Copia o texto informado para a área de transferência e exibe mensagem de sucesso/erro.\r\n */\r\nexport async function copiarTextoParaAreaTransferencia(\r\n    texto: string,\r\n    areaAviso?: HTMLDivElement,\r\n    mensagemSucesso: string = \"Conteúdo copiado!\",\r\n): Promise<boolean> {\r\n    try {\r\n        await navigator.clipboard.writeText(texto);\r\n        if (areaAviso) {\r\n            exibirAviso(areaAviso, mensagemSucesso, TipoAviso.InfoAlternativo);\r\n        }\r\n        return true;\r\n    } catch {\r\n        if (areaAviso) {\r\n            exibirAviso(areaAviso, \"Não foi possível copiar!\", TipoAviso.Erro);\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * @summary Retorna a área de aviso (toast) disponível na página, se existir.\r\n */\r\nfunction obterAreaAviso(): HTMLDivElement | undefined {\r\n    return (\r\n        (document.getElementById(\"toast\") as HTMLDivElement | null) ||\r\n        (document.getElementById(\"feedback-toast\") as HTMLDivElement | null) ||\r\n        undefined\r\n    );\r\n}\r\n\r\n/**\r\n * @summary Obtém o texto de um elemento pelo seletor, priorizando o conteúdo de <code>.\r\n */\r\nfunction obterTextoParaCopiar(selector: string): string {\r\n    const alvo = document.querySelector<HTMLElement>(selector);\r\n    if (!alvo) throw new Error(`Alvo não encontrado: ${selector}`);\r\n    const code = alvo.querySelector<HTMLElement>(\"code\");\r\n    const fonte = code ?? alvo;\r\n    const texto = (fonte.innerText ?? fonte.textContent ?? \"\").trim();\r\n    return texto;\r\n}\r\n\r\n/**\r\n * @summary Lida com cliques em botões com atributo data-copy-target e copia o conteúdo alvo.\r\n */\r\ndocument.addEventListener(\"click\", async (ev) => {\r\n    const origem = ev.target as HTMLElement | null;\r\n    if (!origem) return;\r\n    const botao = origem.closest<HTMLElement>(\"[data-copy-target]\");\r\n    if (!botao) return;\r\n    const seletor = botao.getAttribute(\"data-copy-target\");\r\n    if (!seletor) return;\r\n    ev.preventDefault();\r\n    try {\r\n        const texto = obterTextoParaCopiar(seletor);\r\n        await copiarTextoParaAreaTransferencia(texto, obterAreaAviso());\r\n    } catch {\r\n        await copiarTextoParaAreaTransferencia(\"\", obterAreaAviso());\r\n    }\r\n});\r\n\r\n/**\r\n * @summary Retorna o elemento de feedback de compartilhamento, se presente.\r\n */\r\nfunction obterFeedbackCompartilhamento(): HTMLParagraphElement | undefined {\r\n    return document.getElementById(\"feedback-compartilhamento\") as HTMLParagraphElement | undefined;\r\n}\r\n\r\n/**\r\n * @summary Obtém o conteúdo da meta tag de descrição da página.\r\n */\r\nfunction obterMetaDescricao(): string | undefined {\r\n    const meta = document.querySelector<HTMLMetaElement>('meta[name=\"description\"]');\r\n    return meta?.content?.trim() || undefined;\r\n}\r\n\r\n/**\r\n * @summary Retorna a URL canônica da página, ou o location.href como fallback.\r\n */\r\nfunction obterUrlCompartilhamento(): string {\r\n    const link = document.querySelector<HTMLLinkElement>('link[rel=\"canonical\"]');\r\n    return (link?.href?.trim() || location.href);\r\n}\r\n\r\n/**\r\n * @summary Tenta compartilhar a página via Web Share API; se não disponível, copia o link.\r\n */\r\nasync function compartilharAtual(): Promise<void> {\r\n    const url = obterUrlCompartilhamento();\r\n    const titulo = document.title;\r\n    const texto = obterMetaDescricao() || titulo;\r\n    const area = obterAreaAviso();\r\n    const feedback = obterFeedbackCompartilhamento();\r\n\r\n    try {\r\n        if (navigator.share) {\r\n            await navigator.share({ title: titulo, text: texto, url });\r\n            if (feedback) feedback.textContent = \"Compartilhado!\";\r\n            if (area) exibirAviso(area, \"Compartilhado!\", TipoAviso.Sucesso);\r\n            return;\r\n        }\r\n        // Fallback: copiar URL\r\n        await copiarTextoParaAreaTransferencia(url, area, \"Link copiado!\");\r\n        if (feedback) feedback.textContent = \"Link copiado para a área de transferência.\";\r\n    } catch (e: unknown) {\r\n        const nome = (e as any)?.name as string | undefined;\r\n        if (nome === \"AbortError\") return;\r\n        await copiarTextoParaAreaTransferencia(url, area, \"Link copiado!\");\r\n        if (feedback) feedback.textContent = \"Link copiado para a área de transferência.\";\r\n    }\r\n}\r\n\r\n/**\r\n * @summary Lida com cliques em elementos de compartilhamento e aciona a função de compartilhamento.\r\n */\r\ndocument.addEventListener(\"click\", (ev) => {\r\n    const alvo = ev.target as HTMLElement | null;\r\n    if (!alvo) return;\r\n    const share = alvo.closest<HTMLElement>(\"#botao-compartilhar, [data-share]\");\r\n    if (!share) return;\r\n    ev.preventDefault();\r\n    compartilharAtual();\r\n});\r\n\r\n/* ============================\r\n   Injeção do Google Tag Manager\r\n============================ */\r\nconst GTM_ID = \"GTM-5LSGCFMM\";\r\nconst GTM_SCRIPT_CONTEUDO = `(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\r\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\r\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\r\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\r\n})(window,document,'script','dataLayer','${GTM_ID}');`;\r\nconst PADRAO_COMENTARIO_GTM = /Google Tag Manager/i;\r\n\r\n/**\r\n * @summary Remove comentários adjacentes relacionados ao GTM e o elemento informado.\r\n */\r\nfunction limparElementoGTM(elemento: Element): void {\r\n    let anterior = elemento.previousSibling;\r\n    while (anterior && anterior.nodeType === Node.COMMENT_NODE && PADRAO_COMENTARIO_GTM.test(anterior.nodeValue ?? \"\")) {\r\n        const alvo = anterior;\r\n        anterior = anterior.previousSibling;\r\n        alvo.remove();\r\n    }\r\n\r\n    let posterior = elemento.nextSibling;\r\n    while (posterior && posterior.nodeType === Node.COMMENT_NODE && PADRAO_COMENTARIO_GTM.test(posterior.nodeValue ?? \"\")) {\r\n        const alvo = posterior;\r\n        posterior = posterior.nextSibling;\r\n        alvo.remove();\r\n    }\r\n\r\n    elemento.remove();\r\n}\r\n\r\n/**\r\n * @summary Injeta o bloco de script do Google Tag Manager no topo do <head>.\r\n */\r\nfunction injetarScriptGTM(): void {\r\n    const cabecalho = document.head;\r\n    if (!cabecalho) return;\r\n\r\n    const existentes = cabecalho.querySelectorAll<HTMLScriptElement>(\"script\");\r\n    existentes.forEach((script) => {\r\n        const conteudo = script.textContent ?? \"\";\r\n        if (conteudo.includes(\"googletagmanager.com/gtm.js\") && conteudo.includes(GTM_ID)) {\r\n            limparElementoGTM(script);\r\n        }\r\n    });\r\n\r\n    const comentarioInicial = document.createComment(\" Google Tag Manager \");\r\n    const script = document.createElement(\"script\");\r\n    script.text = GTM_SCRIPT_CONTEUDO;\r\n    const comentarioFinal = document.createComment(\" End Google Tag Manager \");\r\n\r\n    const fragmento = document.createDocumentFragment();\r\n    fragmento.append(comentarioInicial, script, comentarioFinal);\r\n    cabecalho.insertBefore(fragmento, cabecalho.firstChild);\r\n}\r\n\r\n/**\r\n * @summary Injeta o bloco <noscript> do Google Tag Manager logo após o <body>.\r\n */\r\nfunction injetarNoscriptGTM(): void {\r\n    const corpo = document.body;\r\n    if (!corpo) return;\r\n\r\n    const existentes = corpo.querySelectorAll<HTMLElement>(\"noscript\");\r\n    existentes.forEach((noscript) => {\r\n        const conteudo = noscript.textContent ?? \"\";\r\n        const iframe = noscript.querySelector(\"iframe\");\r\n        const src = iframe?.getAttribute(\"src\") ?? \"\";\r\n        if (conteudo.includes(GTM_ID) || src.includes(GTM_ID)) {\r\n            limparElementoGTM(noscript);\r\n        }\r\n    });\r\n\r\n    const comentarioInicial = document.createComment(\" Google Tag Manager (noscript) \");\r\n    const noscript = document.createElement(\"noscript\");\r\n    const iframe = document.createElement(\"iframe\");\r\n    iframe.src = `https://www.googletagmanager.com/ns.html?id=${GTM_ID}`;\r\n    iframe.height = \"0\";\r\n    iframe.width = \"0\";\r\n    iframe.style.display = \"none\";\r\n    iframe.style.visibility = \"hidden\";\r\n    noscript.appendChild(iframe);\r\n    const comentarioFinal = document.createComment(\" End Google Tag Manager (noscript) \");\r\n\r\n    const fragmento = document.createDocumentFragment();\r\n    fragmento.append(comentarioInicial, noscript, comentarioFinal);\r\n    corpo.insertBefore(fragmento, corpo.firstChild);\r\n}\r\n\r\n/**\r\n * @summary Inicia a injeção dos blocos do Google Tag Manager na página.\r\n */\r\nfunction injetarGoogleTagManager(): void {\n    if (typeof document === \"undefined\") return;\n    if (typeof window !== \"undefined\" && window.__gtmInjected) return;\n    if (typeof window !== \"undefined\") window.__gtmInjected = true;\n    injetarScriptGTM();\n    injetarNoscriptGTM();\n}\n\r\nif (typeof window !== \"undefined\") {\r\n    const inicializarGTM = () => injetarGoogleTagManager();\r\n    if (document.readyState === \"loading\") {\r\n        document.addEventListener(\"DOMContentLoaded\", inicializarGTM, { once: true });\r\n    } else {\r\n        inicializarGTM();\r\n    }\r\n}\r\n\r\nexport { injetarGoogleTagManager };\r\n"]}